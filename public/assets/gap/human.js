function human(t,e){this.title=exist(e)?e:"Human",this.alias=this.title[0].toLowerCase(),this.age=0,this.height=100,this.width=46,this.canvas=200,this.x=0,this.y=0,this.angle=0,this.land=0,this.selector=t,this._salary=0,this._saved=0,this._tsalary=0,this._tsaved=0,this._stage=[],this.outrun=!1,this.gap_percent=0,this.saving_for_tick=0,this.animated=!1,this.treasure=[0,0,0,0,0,0],this._path=document.createElementNS("http://www.w3.org/2000/svg","path"),this.path_length=0,this.traversed_path=0,this.path_loop=!1,this.movement=0,this.event_by_month=[],this.event_by_period=[],this.place="",this.card=new cardObject(this),this.pedestal=new pedestalObject(this),this.queue=new queueObject({complete:queueCompleteCallback}),this.future_reward=0,this.oppenent=null;var n={left:[],right:[],rightCount:[],empty:function(){this.left=[],this.right=[],this.rightCount=[]}};this.__defineGetter__("salary",function(){return this._salary}),this.__defineSetter__("salary",function(t){this._salary=t,this.saving_for_tick=user.salary_percent*this._salary/100}),this.__defineGetter__("saved",function(){return this._saved}),this.__defineSetter__("saved",function(t){this._saved=t}),this.__defineGetter__("tsalary",function(){return this._tsalary}),this.__defineSetter__("tsalary",function(t){this._tsalary=t,$(this.selector).parent().find(".score .tsalary .value").text(t>=0?Math.round10(t):0/0)}),this.__defineGetter__("tsaved",function(){return this._tsaved}),this.__defineSetter__("tsaved",function(t){this._tsaved=t,$(this.selector).parent().find(".score .tsaved .value").text(t>=0?Math.round10(t):0/0)}),this.__defineGetter__("stage",function(){return this._stage}),this.__defineSetter__("stage",function(t){this._stage=t}),this.__defineGetter__("path",function(){return this._path}),this.__defineSetter__("path",function(t){this._path.setAttribute("d",t),this.path_length=this._path.getTotalLength()}),this.__defineGetter__("treasure_count",function(){var t=0;return this.treasure.forEach(function(e){t+=e}),t}),this.position=function(t){return exist(t)&&(exist(t.x)&&(this.x=t.x*img_scaler),exist(t.y)&&(this.y=this.land-(this.land-t.y*img_scaler+this.height)),exist(t.a)&&(this.angle=t.a)),$(this.selector).css({left:this.x+stage_offset,top:this.y}),{human:this.title,x:this.x,y:this.y,a:this.angle}},this.toground=function(){var t=(h-th)/2;this.land=t,this.y=t-this.height},this.tosky=function(){this.y=0-this.height},this.animate=function(t){this.animated=!0,this.path=t.path;var e=this,n=1e3*t.duration/150;$(this.selector).animate({color:"white"},{duration:1e3*t.duration,start:function(){$(e.selector).show()},progress:function(t,r,i){e.position(e.getpathcoordinates(r)),Math.floor10(i/150)<n&&(e.next_movement(),--n)},complete:function(){e.animated=!1,animated=e.animated||e.oppenent.animated,e.work_frame()}})};var r=0,i=0,o=4;this.prepare_reward=function(t,e){var n=this,a=t;if(e||(t=1-t),n.path!=category.stage.frame.reward.path){var s=category.stage.frame.reward;n.path=s.path,n.path_loop=exist(s.loop)?s.loop:!1}if(n.position(coordinateFromPath(t,n.path,n.path_length,1,1)),Math.abs(r-n.x)>o&&(e?n.next_movement():n.prev_movement(),r=n.x),Math.abs(i-n.y)>o&&(e?n.next_movement():n.prev_movement(),i=n.y),!e&&1==a){var s=category.stage.frame.work;n.path=s.path,n.path_loop=exist(s.loop)?s.loop:!1}},this.next_movement=function(){this.movement=++this.movement,11==this.movement&&(this.movement=1),$(this.selector).css("background-image","url(/assets/gap/svg/"+this.alias+"/"+this.alias+this.movement+"r.svg)")},this.prev_movement=function(){this.movement=--this.movement,0==this.movement&&(this.movement=10),$(this.selector).css("background-image","url(/assets/gap/svg/"+this.alias+"/"+this.alias+this.movement+"l.svg)")},this.step_right=function(){var t=this.traversed_path+100/scrolls_for_reward;if(this.path_loop)t=100==t?100:t%100;else if(t>100)return;this.next_movement(),this.traversed_path=t,this.position(this.getpathcoordinates(this.traversed_path/100))},this.step_left=function(){var t=this.traversed_path-100/scrolls_for_reward;if(this.path_loop)t=0>=t?100:t%100;else if(0>=t)return;this.prev_movement(),this.traversed_path=t,this.position(this.getpathcoordinates(this.traversed_path/100))},this.work_frame=function(){var t=category.stage.frame.work;this.path=t.path,this.path_loop=exist(t.loop)?t.loop:!1},this.getpathcoordinates=function(t){var e=Math.round10(100*t),n=this.path.getPointAtLength(this.path_length*(e-1)/100),r=this.path.getPointAtLength(this.path_length*(e+1)/100),i=180*Math.atan2(r.y-n.y,r.x-n.x)/Math.PI,o=this.path.getPointAtLength(this.path_length*e/100);return{x:o.x,y:o.y,a:i}},this.prepare_for_game=function(){var t=12*(max_age-user.age),e=0;this.event_by_month=[],this.event_by_period=[];for(var n=-1,r=!0,i=0;t>=i;++i){i%reward_period==0&&(++n,r=!0),e+=this.saving_for_tick;var o=Math.floor10(e/interest[0].cost);o>0?(this.event_by_month.push(o),e-=o*interest[0].cost,r?(this.event_by_period.push(o),r=!1):this.event_by_period[n]+=o):(r&&(this.event_by_period.push(0),r=!1),this.event_by_month.push(0))}for(var i=1;10>=i;++i){var a=new Image;a.src="/assets/gap/svg/"+this.alias+"/"+this.alias+i+"l.svg",a=new Image,a.src="/assets/gap/svg/"+this.alias+"/"+this.alias+i+"r.svg"}},this.has_future_reward=function(){return this.future_reward=this.event_by_period[pos+1],this.future_reward>0},this.mutate=function(t,e){var r=this;if("undefined"!=typeof t){if(1==t&&(e=r.event_by_period[pos]),"undefined"==typeof e||0==e)return void this.queue.resume();var i=r.treasure,o=!1,a=t-1,s=0,l=0;if(r.inrange(t)&&e>0){var u=i[a]+e,c=states_mutation[a],s=Math.floor10(u/c);if(r.outrun){var f=r.oppenent.hasLevelMutation(t);s>f&&(s=f)}if(s>=1){o=!0;var h=($("."+r.place+" .treasure .pedestal .interestB[data-id="+t+"]"),i[a]),d=e,p=s,m=1,g=c-1;n.empty();for(var v=1;d>=v;++v)p>=m?(n.right.push(m),++m):0!=g?(n.right.push(m-1),--g):n.right.unshift(0);m=1;for(var v=0;d-1>v;++v)n.right[v]!=n.right[v+1]?(n.rightCount.push(m),m=1):++m;void 0!==typeof n.right[0]&&0!=n.right[0]&&n.rightCount.unshift(0),n.rightCount.push(m);var y=n.rightCount.length-1;l=c-n.rightCount[y],i[a]-=l;for(var v=h;v>=1;--v)0==y?n.left.unshift(0):0!=l&&(n.left.unshift(y),l-1==0?(--y,l=c-n.rightCount[y]):--l);for(var v=1;p>=v;++v){for(var b=0,x=0;d>x;++x)if(n.right[x]==v){b=x;break}for(var w=!0,_=0,T={},S=0,C=0,x=h-1;x>=0;--x)if(n.left[x]==v){if(w){var k=$("."+r.place+" .treasure .pedestal .interestB[data-id="+t+"] div.item[data-id="+(x+1)+"]");T.offset=k.offset(),T.position=k.position()}var D=function(t,e,n,i,o,a,s,l){return function(){r.moveTreasureCoinToCard(t,e,n,i,o,a,s,l)}}(t,x,b,w,v,_,T,S);this.queue.splice(C++,D,r.title),w&&(w=!1),++_,++S}w=!0;var E={};_=0;for(var x=0;d>x;++x)if(n.right[x]==v){if(w)w=!1,firtsTmp=$("."+r.place+" .treasure .card .coins .coin:nth-child("+(x+1)+")"),E.offset=firtsTmp.offset(),E.position=firtsTmp.position();else{var D=function(t,e,n,i,o,a){return function(){r.moveCardCoinToParentCardCoin(t,e,n,i,o,a)}}(t,x,b,E,_,S);this.queue.splice(C++,D,r.title),++S}++_}var M=n.rightCount[0],D=function(t,e){return function(){var n=$("."+r.place+" .treasure .card .coins .coin:nth-child("+(t+e)+")");n.animate({color:"white"},{duration:2e3,progress:function(t,e){var n=jQuery.easing.easeOutBounce(.3*e);$(this).css({transform:"scale("+(1+n)+","+(1+n)+")",opacity:1-e})},complete:function(){var t="i"+interest[a].class,e="i"+interest[a+1].class;$(this).removeClass(t).css("transform","scale(1,1)").addClass(e).css("opacity",1),r.queue.resume()}})}}(M,v);this.queue.splice(C++,D)}}else i[a]+=e,this.pedestal.add(t,e)}s>0&&6>=t&&this.queue.splice(-4,function(t,e){return function(){r.mutate(t,e)}}(t+1,s)),this.queue.resume()}};var a="M 0.0473509,55.968433 C 22.205826,24.60457 55.704178,5.2051051 100.0051,0.03123545",s=document.createElementNS("http://www.w3.org/2000/svg","path");s.setAttribute("d",a);var l=s.getTotalLength();this.moveTreasureCoinToCard=function(t,e,n,r,i,o,a,u){var c=this,f=$("."+c.place+" .treasure .pedestal .interestB[data-id="+t+"]"),h=f.find("div.item[data-id="+(e+1)+"]"),d=a.offset.left,p=$("."+c.place+" .treasure .card .coins .coin:nth-child("+(n+1)+")"),m=(p.offset().left-d)/100,g=0;g="top"==c.place?lh-p.offset().top-32-10:p.offset().top-lh-th-10;var v=g/56,y=200,b=300*o;h.data("itemNumber",u),r?h.animate({color:"#ffffff"},{duration:y,progress:function(t,e){var n=coordinateFromPath(e,s,l,m,v);$(this).css({left:n.x,top:("top"==c.place?-1:1)*(56*v-n.y)})},complete:function(){var t=+h.data("itemNumber");h.remove(),p.css("transform","scale("+(1+t/10)+","+(1+(t+1)/10)+")"),c.queue.resume()}}):(h.data("ileft",h.position().left),h.delay(b).animate({left:a.position.left-h.position().left},{duration:500,complete:function(){$(this).animate({color:"#ffffff"},{duration:y,progress:function(t,e){var n=coordinateFromPath(e,s,l,m,v);$(this).css({left:n.x+(a.position.left-+h.data("ileft")),top:("top"==c.place?-1:1)*(56*v-n.y)})},complete:function(){var t=+h.data("itemNumber");h.remove(),p.css("transform","scale("+(1+t/10)+","+(1+(t+1)/10)+")"),c.queue.resume()}})}}))},this.moveCardCoinToParentCardCoin=function(t,e,n,r,i,o){var a=this,s=300*i,l=$("."+a.place+" .treasure .card .coins .coin:nth-child("+(n+1)+")"),u=$("."+a.place+" .treasure .card .coins .coin:nth-child("+(e+1)+")");u.data("itemNumber",o),u.delay(s).animate({left:u.position().left-r.position.left},{duration:500,complete:function(){var t=+u.data("itemNumber");u.remove(),l.css("transform","scale("+(1+t/10)+","+(1+(t+1)/10)+")"),a.queue.resume()}})},this.hasLevelMutation=function(t){var e=this;if(!(t>=1&&4>=t))return 999;for(var n=0,r=0;pos-1>=r;++r)n+=e.event_by_period[r];for(var r=4;r>=0&&(n-=Math.floor10(n/states_mutation_based[r])*states_mutation_based[r],r!=t-1);--r);return Math.floor10((e.event_by_period[pos]+n)/states_mutation_based[t-1])},this.inrange=function(t){return t>=1&&6>t?!0:!1},this.init=function(){this.card.init(),this.pedestal.init()}}function h_go_right(){male.step_right(),female.step_right()}function h_go_left(){male.step_left(),female.step_left()}male=new human(".m.character","Male"),female=new human(".f.character","Female"),humans=male.outrun?[male,female]:[female,male];